function site = SAbo14(Vs30,pga_rock_g,T)
  % Computes the site amplification correction term.  Code is vectorized.
  % 
  % Reference:
  % Boore, Stewart, Seyhan, & Atkinson, (2014). NGA-West2 equations for predicting PGA, PGV, and 5% damped PSA for shallow crustal earthquakes. Earthquake Spectra, 30(3), 1057-1085, doi: 10.1193/070113EQS184M.
  % 
  % Written by Benjamin Edwards, modified slightly by Ryan Schultz.
  
  % Table of values.
  c=[       -1 -8.400000E-01 1.300000E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.000000E-01 -8.440000E-03;...
             0 -6.000000E-01 1.500000E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.500000E-01 -7.010000E-03;...
  1.000000E-02 -6.037200E-01 1.500200E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.483300E-01 -7.010000E-03;...
  2.000000E-02 -5.738800E-01 1.500360E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.471000E-01 -7.280000E-03;...
  2.200000E-02 -5.667500E-01 1.500680E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.480100E-01 -7.320000E-03;...
  2.500000E-02 -5.552000E-01 1.501040E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.501500E-01 -7.360000E-03;...
  2.900000E-02 -5.385000E-01 1.501260E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.538700E-01 -7.370000E-03;...
  3.000000E-02 -5.341400E-01 1.502950E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.548500E-01 -7.350000E-03;...
  3.200000E-02 -5.252900E-01 1.503120E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.568500E-01 -7.310000E-03;...
  3.500000E-02 -5.119200E-01 1.503240E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.601600E-01 -7.210000E-03;...
  3.600000E-02 -5.075200E-01 1.503320E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.614200E-01 -7.170000E-03;...
  4.000000E-02 -4.906500E-01 1.503350E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.677700E-01 -6.980000E-03;...
  4.200000E-02 -4.829000E-01 1.503340E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.719300E-01 -6.870000E-03;...
  4.400000E-02 -4.757200E-01 1.503130E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.766400E-01 -6.770000E-03;...
  4.500000E-02 -4.723600E-01 1.502840E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.791400E-01 -6.720000E-03;...
  4.600000E-02 -4.691500E-01 1.502470E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.817000E-01 -6.670000E-03;...
  4.800000E-02 -4.632100E-01 1.502010E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.868800E-01 -6.560000E-03;...
  5.000000E-02 -4.579500E-01 1.501420E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.920000E-01 -6.470000E-03;...
  5.500000E-02 -4.478700E-01 1.500710E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.036900E-01 -6.250000E-03;...
  6.000000E-02 -4.418600E-01 1.499830E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.137400E-01 -6.070000E-03;...
  6.500000E-02 -4.395100E-01 1.498740E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.222500E-01 -5.930000E-03;...
  6.700000E-02 -4.395000E-01 1.497420E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.252400E-01 -5.880000E-03;...
  7.000000E-02 -4.404000E-01 1.495850E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.293100E-01 -5.820000E-03;...
  7.500000E-02 -4.441100E-01 1.494000E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.350000E-01 -5.730000E-03;...
  8.000000E-02 -4.502000E-01 1.491820E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.394400E-01 -5.670000E-03;...
  8.500000E-02 -4.581300E-01 1.489290E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.428500E-01 -5.630000E-03;...
  9.000000E-02 -4.673200E-01 1.486360E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.454400E-01 -5.610000E-03;...
  9.500000E-02 -4.772100E-01 1.482980E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.474700E-01 -5.600000E-03;...
  1.000000E-01 -4.872400E-01 1.479120E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.491600E-01 -5.600000E-03;...
  1.100000E-01 -5.063200E-01 1.474740E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.521300E-01 -5.620000E-03;...
  1.200000E-01 -5.243800E-01 1.469750E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.545500E-01 -5.670000E-03;...
  1.300000E-01 -5.421400E-01 1.464090E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.562800E-01 -5.720000E-03;...
  1.330000E-01 -5.475200E-01 1.457760E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.566500E-01 -5.740000E-03;...
  1.400000E-01 -5.603200E-01 1.450710E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.571900E-01 -5.780000E-03;...
  1.500000E-01 -5.796200E-01 1.442850E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.571300E-01 -5.850000E-03;...
  1.600000E-01 -6.005200E-01 1.434220E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.560400E-01 -5.910000E-03;...
  1.700000E-01 -6.225200E-01 1.424850E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.541400E-01 -5.970000E-03;...
  1.800000E-01 -6.448600E-01 1.414770E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.517300E-01 -6.020000E-03;...
  1.900000E-01 -6.668100E-01 1.403990E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.491100E-01 -6.080000E-03;...
  2.000000E-01 -6.876200E-01 1.392610E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.465800E-01 -6.140000E-03;...
  2.200000E-01 -7.243100E-01 1.380720E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.423500E-01 -6.260000E-03;...
  2.400000E-01 -7.564600E-01 1.368510E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.382300E-01 -6.380000E-03;...
  2.500000E-01 -7.717700E-01 1.356210E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.357400E-01 -6.440000E-03;...
  2.600000E-01 -7.869700E-01 1.343890E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.328000E-01 -6.500000E-03;...
  2.800000E-01 -8.161300E-01 1.331670E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.260100E-01 -6.600000E-03;...
  2.900000E-01 -8.295000E-01 1.319830E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.225000E-01 -6.650000E-03;...
  3.000000E-01 -8.416500E-01 1.308470E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.191200E-01 -6.700000E-03;...
  3.200000E-01 -8.617500E-01 1.297650E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.131800E-01 -6.800000E-03;...
  3.400000E-01 -8.772600E-01 1.287500E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.081600E-01 -6.890000E-03;...
  3.500000E-01 -8.837500E-01 1.278060E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.059200E-01 -6.930000E-03;...
  3.600000E-01 -8.896500E-01 1.269190E+03 7.600000E+02 0.000000E+00 1.000000E-01 -2.037900E-01 -6.970000E-03;...
  3.800000E-01 -9.003800E-01 1.260740E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.997800E-01 -7.050000E-03;...
  4.000000E-01 -9.109200E-01 1.252660E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.958200E-01 -7.130000E-03;...
  4.200000E-01 -9.224100E-01 1.244800E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.917100E-01 -7.190000E-03;...
  4.400000E-01 -9.345900E-01 1.237030E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.874700E-01 -7.260000E-03;...
  4.500000E-01 -9.407500E-01 1.229230E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.853400E-01 -7.290000E-03;...
  4.600000E-01 -9.468600E-01 1.221160E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.832100E-01 -7.320000E-03;...
  4.800000E-01 -9.586300E-01 1.212740E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.790200E-01 -7.380000E-03;...
  5.000000E-01 -9.693000E-01 1.203910E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.750000E-01 -7.440000E-03;...
  5.500000E-01 -9.892500E-01 1.194590E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.660100E-01 -7.580000E-03;...
  6.000000E-01 -1.001200E+00 1.184930E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.583000E-01 -7.730000E-03;...
  6.500000E-01 -1.007800E+00 1.175190E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.514400E-01 -7.870000E-03;...
  6.670000E-01 -1.009300E+00 1.165690E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.492300E-01 -7.920000E-03;...
  7.000000E-01 -1.011700E+00 1.156460E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.450300E-01 -8.000000E-03;...
  7.500000E-01 -1.015400E+00 1.147590E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.386600E-01 -8.120000E-03;...
  8.000000E-01 -1.021000E+00 1.139210E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.320100E-01 -8.220000E-03;...
  8.500000E-01 -1.028200E+00 1.131340E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.251700E-01 -8.300000E-03;...
  9.000000E-01 -1.036000E+00 1.123910E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.183100E-01 -8.360000E-03;...
  9.500000E-01 -1.043600E+00 1.116830E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.116000E-01 -8.410000E-03;...
  1.000000E+00 -1.050000E+00 1.109950E+03 7.600000E+02 0.000000E+00 1.000000E-01 -1.052100E-01 -8.440000E-03;...
  1.100000E+00 -1.057300E+00 1.103070E+03 7.600000E+02 0.000000E+00 1.000000E-01 -9.383700E-02 -8.470000E-03;...
  1.200000E+00 -1.058400E+00 1.096040E+03 7.600000E+02 0.000000E+00 1.000000E-01 -8.414400E-02 -8.420000E-03;...
  1.300000E+00 -1.055400E+00 1.088670E+03 7.600000E+02 0.000000E+00 1.000000E-01 -7.581900E-02 -8.290000E-03;...
  1.400000E+00 -1.050400E+00 1.080770E+03 7.600000E+02 0.000000E+00 1.000000E-01 -6.854300E-02 -8.060000E-03;...
  1.500000E+00 -1.045400E+00 1.072390E+03 7.600000E+02 0.000000E+00 1.000000E-01 -6.200000E-02 -7.710000E-03;...
  1.600000E+00 -1.042100E+00 1.061770E+03 7.600000E+02 0.000000E+00 1.000000E-01 -5.592700E-02 -7.230000E-03;...
  1.700000E+00 -1.040400E+00 1.049290E+03 7.600000E+02 0.000000E+00 1.000000E-01 -5.028600E-02 -6.660000E-03;...
  1.800000E+00 -1.039700E+00 1.036420E+03 7.600000E+02 0.000000E+00 1.000000E-01 -4.509600E-02 -6.030000E-03;...
  1.900000E+00 -1.039500E+00 1.023140E+03 7.600000E+02 0.000000E+00 1.000000E-01 -4.037300E-02 -5.400000E-03;...
  2.000000E+00 -1.039200E+00 1.009490E+03 7.600000E+02 0.000000E+00 1.000000E-01 -3.613600E-02 -4.790000E-03;...
  2.200000E+00 -1.036800E+00 9.955200E+02 7.600000E+02 0.000000E+00 1.000000E-01 -2.910500E-02 -3.780000E-03;...
  2.400000E+00 -1.032300E+00 9.813300E+02 7.600000E+02 0.000000E+00 1.000000E-01 -2.371000E-02 -3.020000E-03;...
  2.500000E+00 -1.029400E+00 9.669400E+02 7.600000E+02 0.000000E+00 1.000000E-01 -2.150900E-02 -2.720000E-03;...
  2.600000E+00 -1.026200E+00 9.523400E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.957600E-02 -2.460000E-03;...
  2.800000E+00 -1.019000E+00 9.375200E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.632400E-02 -2.080000E-03;...
  3.000000E+00 -1.011200E+00 9.224300E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.357700E-02 -1.830000E-03;...
  3.200000E+00 -1.003200E+00 9.087900E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.103000E-02 -1.670000E-03;...
  3.400000E+00 -9.951200E-01 8.961500E+02 7.600000E+02 0.000000E+00 1.000000E-01 -8.665200E-03 -1.580000E-03;...
  3.500000E+00 -9.910000E-01 8.831600E+02 7.600000E+02 0.000000E+00 1.000000E-01 -7.568200E-03 -1.550000E-03;...
  3.600000E+00 -9.868200E-01 8.700500E+02 7.600000E+02 0.000000E+00 1.000000E-01 -6.537400E-03 -1.540000E-03;...
  3.800000E+00 -9.782600E-01 8.570700E+02 7.600000E+02 0.000000E+00 1.000000E-01 -4.701600E-03 -1.520000E-03;...
  4.000000E+00 -9.693800E-01 8.444800E+02 7.600000E+02 0.000000E+00 1.000000E-01 -3.212300E-03 -1.520000E-03;...
  4.200000E+00 -9.601200E-01 8.324500E+02 7.600000E+02 0.000000E+00 1.000000E-01 -2.103300E-03 -1.520000E-03;...
  4.400000E+00 -9.504900E-01 8.211800E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.324400E-03 -1.500000E-03;...
  4.600000E+00 -9.405000E-01 8.107900E+02 7.600000E+02 0.000000E+00 1.000000E-01 -8.042200E-04 -1.480000E-03;...
  4.800000E+00 -9.301800E-01 8.014100E+02 7.600000E+02 0.000000E+00 1.000000E-01 -4.714500E-04 -1.460000E-03;...
  5.000000E+00 -9.195400E-01 7.931300E+02 7.600000E+02 0.000000E+00 1.000000E-01 -2.548000E-04 -1.440000E-03;...
  5.500000E+00 -8.917600E-01 7.857300E+02 7.600000E+02 0.000000E+00 1.000000E-01 7.238300E-05 -1.400000E-03;...
  6.000000E+00 -8.628600E-01 7.799100E+02 7.600000E+02 0.000000E+00 1.000000E-01 1.877000E-04 -1.380000E-03;...
  6.500000E+00 -8.335500E-01 7.756000E+02 7.600000E+02 0.000000E+00 1.000000E-01 1.594500E-04 -1.370000E-03;...
  7.000000E+00 -8.045700E-01 7.726800E+02 7.600000E+02 0.000000E+00 1.000000E-01 5.592000E-05 -1.370000E-03;...
  7.500000E+00 -7.766500E-01 7.710100E+02 7.600000E+02 0.000000E+00 1.000000E-01 -5.460000E-05 -1.370000E-03;...
  8.000000E+00 -7.503300E-01 7.608100E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.172400E-04 -1.370000E-03;...
  8.500000E+00 -7.254400E-01 7.645000E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.308400E-04 -1.370000E-03;...
  9.000000E+00 -7.016100E-01 7.680700E+02 7.600000E+02 0.000000E+00 1.000000E-01 -1.076600E-04 -1.370000E-03;...
  9.500000E+00 -6.785000E-01 7.715500E+02 7.600000E+02 0.000000E+00 1.000000E-01 -5.996200E-05 -1.360000E-03;...
  1.000000E+01 -6.557500E-01 7.750000E+02 7.600000E+02 0.000000E+00 1.000000E-01 0.000000E+00 -1.360000E-03];
  
  % Define factors.
  if(T==-1)
      index=1; % PGV.
      clin  = c(index,2);
      Vc    = c(index,3);
      VsRef = c(index,4);
      f1 = c(index,5);
      f3 = c(index,6);
      f4 = c(index,7);
      f5 = c(index,8);
  elseif(T==0)
      index=2; % PGA.
      clin  = c(index,2);
      Vc    = c(index,3);
      VsRef = c(index,4);
      f1 = c(index,5);
      f3 = c(index,6);
      f4 = c(index,7);
      f5 = c(index,8);
  else
      % PSA.
      clin  = interp1(c(:,1),c(:,2),T,'linear');
      Vc    = interp1(c(:,1),c(:,3),T,'linear');
      VsRef = interp1(c(:,1),c(:,4),T,'linear');
      f1 = interp1(c(:,1),c(:,5),T,'linear');
      f3 = interp1(c(:,1),c(:,6),T,'linear');
      f4 = interp1(c(:,1),c(:,7),T,'linear');
      f5 = interp1(c(:,1),c(:,8),T,'linear');
  end
  
  % Define more factors.
  V760=760*ones(size(Vs30));
  Vc2=Vc*ones(size(Vs30));
  f2 = f4*(exp(f5*(min(Vs30,V760)-360))-exp(f5*(760-360)));
  
  % Compute linear and non-linaer site amplification.
  site_lin=(clin*log(min(Vs30,Vc2)/VsRef));
  site_nonlin=f2.*log((pga_rock_g+f3)/f3);
  
  % Composite site amplification.
  site=site_lin+site_nonlin;
  
return